{% extends "base.html" %}
{% block content %}
<h2>Pedidos (Cocina)</h2>
<table class="table">
  <thead>
    <tr>
      <th>ID Detalle</th>
      <th>Pedido</th>
      <th>Producto</th>
      <th>Cantidad</th>
      <th>Preparado</th>
      <th>Acción</th>
    </tr>
  </thead>
  <tbody>
    {% for detalle in detalles %}
    <tr>
      <td>{{ detalle.id }}</td>
      <td>{{ detalle.pedido.id }}</td>
      <td>{{ detalle.producto.nombre }}</td>
      <td>{{ detalle.cantidad }}</td>
      <td>{{ 'Sí' if detalle.preparado else 'No' }}</td>
      <td>
        {% if not detalle.preparado %}
        <form action="{{ url_for('cocina.preparado', detalle_id=detalle.id) }}" method="POST">
          <button type="submit" class="btn btn-sm btn-primary">Marcar preparado</button>
        </form>
        {% else %}
        <span class="text-success">Preparado</span>
        {% endif %}
      </td>
    </tr>
    {% endfor %}
  </tbody>
  <script>
    function cargarPedidos() {
      fetch('/api/pedidos')
        .then(response => response.json())
        .then(data => {
          // Aquí va tu lógica de renderizado dinámico o actualización de tabla
          console.log("Pedidos actualizados:", data);
        });
    }
    
    setInterval(cargarPedidos, 10000); // Actualiza cada 10 segundos
    window.onload = cargarPedidos;
    </script>
    
</table>
<script>
setTimeout(function(){
   window.location.reload(1);
}, 30000);
</script>
{% endblock %}
